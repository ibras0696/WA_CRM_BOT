# CRM WA Bot

> WhatsApp –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É—á—ë—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ–Ω—Ç—Ä–æ–ª—è –ª–∏–º–∏—Ç–æ–≤ –∏ –≤—ã–ø—É—Å–∫–æ–≤ —Ä–∞—Å—Å—Ä–æ—á–µ–∫.  
> –û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: [github.com/ibras0696/WA_CRM_BOT](https://github.com/ibras0696/WA_CRM_BOT)

## –ù–∞–≤–∏–≥–∞—Ü–∏—è
1. [–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –±–æ—Ç](#–ø–æ—á–µ–º—É-—ç—Ç–æ—Ç-–±–æ—Ç)
2. [–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏](#—á—Ç–æ-–≤–Ω—É—Ç—Ä–∏)
3. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
4. [–ö–æ–º–∞–Ω–¥—ã –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏](#–∫–æ–º–∞–Ω–¥—ã-–∏-–ø–æ–¥—Å–∫–∞–∑–∫–∏)
5. [–°—Ü–µ–Ω–∞—Ä–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞](#—Å—Ü–µ–Ω–∞—Ä–∏–∏-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
6. [–°—Ü–µ–Ω–∞—Ä–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞](#—Å—Ü–µ–Ω–∞—Ä–∏–∏-—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
7. [–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å](#—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è-–º–æ–¥–µ–ª—å)
8. [–û—Ç—á—ë—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞](#–æ—Ç—á—ë—Ç—ã-–∏-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
9. [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã](#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–∏-—Å–µ—Ä–≤–∏—Å–Ω—ã–µ-–∫–æ–º–∞–Ω–¥—ã)
10. [–ü–æ–ª–µ–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã](#–ø–æ–ª–µ–∑–Ω—ã–µ-–º–∞—Ç–µ—Ä–∏–∞–ª—ã)

---

## –ü–æ—á–µ–º—É —ç—Ç–æ—Ç –±–æ—Ç
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.** –í–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –µ—Å—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏: ¬´–ê–¥–º–∏–Ω ‚Äî –º–µ–Ω—é –∞–¥–º–∏–Ω–∞, –ú–µ–Ω–µ–¥–∂–µ—Ä ‚Äî –º–µ–Ω—é —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞¬ª.
- **–í—Å—ë —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.** –ë–∞–ª–∞–Ω—Å—ã –ø–æ –Ω–∞–ª–∏—á–∫–µ –∏ –±–∞–Ω–∫—É –≤–µ–¥—É—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–µ–ª—è—Ç—Å—è –Ω–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∏ –≤—ã–¥–∞—á–∏ —Ä–∞—Å—Å—Ä–æ—á–µ–∫.
- **–û—Ç—á—ë—Ç–Ω–æ—Å—Ç—å –≤ –¥–≤–∞ –∫–ª–∏–∫–∞.** –í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –µ—Å—Ç—å –±—ã—Å—Ç—Ä—ã–µ –æ—Ç—á—ë—Ç—ã –∑–∞ –¥–µ–Ω—å/–º–µ—Å—è—Ü/–≥–æ–¥ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –ø–µ—Ä–∏–æ–¥—É.
- **–î–æ–∫–µ—Ä–∏–∑–∞—Ü–∏—è.** `docker-compose` + `Makefile` ‚Üí –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –∑–∞ –ø–∞—Ä—É –∫–æ–º–∞–Ω–¥.

## –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏
- Green API + `whatsapp-chatbot-python` ‚Äî –æ–±—â–µ–Ω–∏–µ —Å WhatsApp.
- FSM-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `crm_bot/handlers` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∫–Ω–æ–ø–æ–∫ –∏ –≤–≤–æ–¥–æ–≤.
- –°–µ—Ä–≤–∏—Å—ã –≤ `crm_bot/services` ‚Äî –≤—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Ä–∞—Å—á—ë—Ç—ã —Ä–∞—Å—Å—Ä–æ—á–µ–∫.
- PostgreSQL + SQLAlchemy + Alembic ‚Äî –¥–∞–Ω–Ω—ã–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏.
- –°–∫—Ä–∏–ø—Ç—ã (`crm_bot/scripts`) ‚Äî —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–º–µ–Ω).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: Docker, Docker Compose, Python 3.12 (–µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ), –¥–µ–π—Å—Ç–≤—É—é—â–∏–π –∞–∫–∫–∞—É–Ω—Ç Green API.

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` ‚Üí `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                               |
|-------------------|----------------------------------------------------------|
| `ID_INSTANCE`     | ID –∏–Ω—Å—Ç–∞–Ω—Å–∞ Green API                                    |
| `API_TOKEN`       | –¢–æ–∫–µ–Ω Green API                                          |
| `DATABASE_URL`    | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL                          |
| `ADMIN_PHONE`     | –ì–ª–∞–≤–Ω—ã–π –Ω–æ–º–µ—Ä –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Ñ–æ—Ä–º–∞—Ç `7XXXXXXXXXX`)      |
| `ADMIN_PHONES`    | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –∞–¥–º–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)|
| `COMPANY_NAME`    | –ò–º—è –∫–æ–º–ø–∞–Ω–∏–∏ –≤ –ø–æ–¥—Å–∫–∞–∑–∫–∞—Ö –±–æ—Ç–∞                           |
| `BOT_DEBUG`       | `True/False`, –≤–ª–∏—è–µ—Ç –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è              |
| `GREEN_API_HOST`  | URL Green API (–æ–±—ã—á–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π)                       |
| `GREEN_API_MEDIA` | Endpoint –¥–ª—è –º–µ–¥–∏–∞                                       |

2. –ü–æ–¥–Ω–∏–º–∏—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
```bash
make up           # —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make migrate      # alembic upgrade head
make seed         # —Å–æ–∑–¥–∞—ë—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞(–æ–≤)
```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `make logs` ‚Äî –±–æ—Ç –¥–æ–ª–∂–µ–Ω —Å–ª—É—à–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

## –ö–æ–º–∞–Ω–¥—ã –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏
- `–ê–¥–º–∏–Ω` ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ whitelisted –Ω–æ–º–µ—Ä–∞–º).
- `–ú–µ–Ω–µ–¥–∂–µ—Ä` ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–Ω–æ–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω).
- `help`, `–ø–æ–º–æ—â—å`, `–º–µ–Ω—é` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –ø–∞–º—è—Ç–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫, –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ –ø—Ä–∞–≤–∏–ª.
- –ù–∞ –ª—é–±–æ–º —à–∞–≥–µ FSM `–ê–¥–º–∏–Ω`/`–ú–µ–Ω–µ–¥–∂–µ—Ä` —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –º–µ–Ω—é; `–æ—Ç–º–µ–Ω–∞` –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ–¥—É—Ä—É –±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –º–µ–Ω—é.

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
–î–æ—Å—Ç—É–ø–Ω—ã –Ω–æ–º–µ—Ä–∞–º –∏–∑ `ADMIN_PHONE`/`ADMIN_PHONES`.

| –ö–Ω–æ–ø–∫–∞                  | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                                                                                      |
|-------------------------|------------------------------------------------------------------------------------------------------------------|
| **–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞** | –ù—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–æ–º–µ—Ä `7XXXXXXXXXX`. –ë–æ—Ç —Å–∞–º –¥–æ–±–∞–≤–∏—Ç `@c.us`, –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ.      |
| **–û—Ç–∫–ª—é—á–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞**| –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞. –ö–æ–º–∞–Ω–¥–∞ –æ–±—Ä–∞—Ç–∏–º–∞ ‚Äî –º–æ–∂–Ω–æ –≤–Ω–æ–≤—å –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä.                                    |
| **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –±–∞–ª–∞–Ω—Å–∞** | –°–±–æ—Ä –Ω–æ–º–µ—Ä–∞ ‚Üí –≤—ã–±–æ—Ä –∫–∞—Ä–º–∞–Ω–∞ (–Ω–∞–ª/–±–∞–Ω–∫) ‚Üí –≤–≤–æ–¥ –¥–µ–ª—å—Ç—ã (`+` –∏–ª–∏ `-`). –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π. |
| **–£–¥–∞–ª–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é**    | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–µ–∂–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è –∏ –ø—Ä–æ—Å–∏—Ç ID. –î–µ–ª–∞–µ—Ç soft-delete (–±–∞–ª–∞–Ω—Å –Ω–µ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è).                  |
| **–û—Ç—á—ë—Ç**               | –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ `YYYY-MM-DD [YYYY-MM-DD] [–Ω–æ–º–µ—Ä]`. –ë–µ–∑ –Ω–æ–º–µ—Ä–∞ –æ—Ç—á—ë—Ç –ø–æ –≤—Å–µ–π –∫–æ–º–∞–Ω–¥–µ, —Å –Ω–æ–º–µ—Ä–æ–º ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π.     |
| **–û—Ç—á—ë—Ç –∑–∞ –¥–µ–Ω—å**       | –ë—ã—Å—Ç—Ä—ã–π –æ—Ç—á—ë—Ç –∑–∞ —Ç–µ–∫—É—â–∏–µ —Å—É—Ç–∫–∏ (–ø–æ —á–∞—Å–æ–≤–æ–º—É –ø–æ—è—Å—É Europe/Moscow).                                              |
| **–ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç**        | –ö–Ω–æ–ø–∫–∏ ¬´–ó–∞ –¥–µ–Ω—å / –ó–∞ –º–µ—Å—è—Ü / –ó–∞ –≥–æ–¥ / –ü–µ—Ä–∏–æ–¥¬ª ‚Üí —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–æ–±–æ—Ä–æ—Ç, –ø—Ä–∏—Ö–æ–¥/—Ä–∞—Å—Ö–æ–¥, —Ä–∞–∑—Ä–µ–∑—ã –ø–æ —Ç–∏–ø–∞–º). |

–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –ø–æ–¥—Å–∫–∞–∑–∫–æ–π ¬´‚ÑπÔ∏è –ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∞–¥–º–∏–Ω-–º–µ–Ω—é, –Ω–∞–ø–∏—à–∏—Ç–µ `–ê–¥–º–∏–Ω`¬ª.

## –°—Ü–µ–Ω–∞—Ä–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
–ê–∫—Ü–µ–ø—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä.

| –ö–Ω–æ–ø–∫–∞                    | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                               |
|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| **–û—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É**         | –ë–æ—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ –Ω–∞–ª–∏—á–∫–µ –∏ –±–∞–Ω–∫—É, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ –ø—Ä–æ—à–ª–æ–π —Å–º–µ–Ω—ã. –°–∏–º–≤–æ–ª `+` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.      |
| **–ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É**         | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Å–º–µ–Ω—É.                                                                                                     |
| **–í—ã–¥–∞—á–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∏**      | –¶–µ–Ω–∞ ‚Üí –ø—Ä–æ—Ü–µ–Ω—Ç ‚Üí —Å—Ä–æ–∫ ‚Üí —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã. –ë–æ—Ç —Å—á–∏—Ç–∞–µ—Ç –Ω–∞—Ü–µ–Ω–∫—É, –ø–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å, —Å—É–º–º—É —Ä–∞—Å—Å—Ä–æ—á–∫–∏, –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂ –∏ —Å—Ä–∞–∑—É —Å–Ω–∏–º–∞–µ—Ç –ª–∏–º–∏—Ç.   |
| **–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è**   | –°—É–º–º–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º (`+` –∏–ª–∏ `-`) ‚Üí –≤—ã–±–æ—Ä ¬´–ù–∞–ª–∏—á–∫–∞/–ë–∞–Ω–∫¬ª. –û—Ç–≤–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç ID –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –±–∞–ª–∞–Ω—Å.                           |
| **–ú–æ–π –±–∞–ª–∞–Ω—Å**            | –†–∞–∑–±–∏–≤–∫–∞ –ø–æ –Ω–∞–ª–∏—á–∫–µ, –±–∞–Ω–∫—É –∏ –æ–±—â–∏–π –∏—Ç–æ–≥.                                                                                                |
| **–ú–æ–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏**          | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (—Ç–∏–ø, —Å—É–º–º–∞, —Å–ø–æ—Å–æ–±, –¥–∞—Ç–∞). –ü–æ—Å–ª–µ —Å–ø–∏—Å–∫–∞ –º–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ `#ID` –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ `ID`, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏, –∏–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å `–ú–µ–Ω–µ–¥–∂–µ—Ä` ‚Äî –Ω–∞–∑–∞–¥. |

–ö–∞–∂–¥–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç: ¬´‚ÑπÔ∏è –ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `1`¬ª.

## –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å
- –ë–∞–ª–∞–Ω—Å —Å–º–µ–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –¥–≤—É—Ö –∫–∞—Ä–º–∞–Ω–∞—Ö: `current_balance_cash` –∏ `current_balance_bank`.
- –û–ø–µ—Ä–∞—Ü–∏–∏ –¥–µ–ª—è—Ç—Å—è –Ω–∞ –¥–≤–∞ —Ç–∏–ø–∞: `–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è` (–ª—é–±–æ–π –ø—Ä–∏—Ö–æ–¥/—Ä–∞—Å—Ö–æ–¥) –∏ `–†–∞—Å—Å—Ä–æ—á–∫–∞` (—Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ + –Ω–∞—Ü–µ–Ω–∫–∞, –æ—Ç–¥–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞).
- –†–∞—Å—Å—Ä–æ—á–∫–∏ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: —Ü–µ–Ω–∞, –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–∞—Ü–µ–Ω–∫–∏, —Å—É–º–º–∞ –ø–µ—Ä–≤–æ–≥–æ –≤–∑–Ω–æ—Å–∞, —Å—Ä–æ–∫ –∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂.
- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –∞–¥–º–∏–Ω–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å —Å–º–µ–Ω –∏ —Å–æ–∑–¥–∞—é—Ç –∑–∞–ø–∏—Å—å `CashTransaction` —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä—É.
- Soft-delete —Ç–æ–ª—å–∫–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –∏–∑ –æ—Ç—á—ë—Ç–æ–≤, –Ω–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–∏–º–∏—Ç ‚Äî –¥–ª—è –æ—Ç–∫–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫—É.

## –û—Ç—á—ë—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
**–ë–∞–∑–æ–≤—ã–π –æ—Ç—á—ë—Ç** (`–û—Ç—á—ë—Ç`):
```
üìä –û—Ç—á—ë—Ç 01.02.2025 ‚Äî 28.02.2025
–í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: 15
üí∏ –í—ã–¥–∞—á–∏: 820 000 (—à—Ç. 9)
‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç—ã: 110 000 (—à—Ç. 3)
üßÆ –ß–∏—Å—Ç—ã–π –∏—Ç–æ–≥: 710 000
–ù–∞–ª–∏—á–∫–∞: 500 000 (—à—Ç. 6)
–ë–∞–Ω–∫: 210 000 (—à—Ç. 3)
üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏:
‚Ä¢ –ò–≤–∞–Ω: –æ–±–æ—Ä–æ—Ç 420 000, –ø—Ä–∏—Ö–æ–¥ 300 000 / —Ä–∞—Å—Ö–æ–¥ 120 000
‚Ä¢ –û–ª—å–≥–∞: –æ–±–æ—Ä–æ—Ç 390 000, –ø—Ä–∏—Ö–æ–¥ 320 000 / —Ä–∞—Å—Ö–æ–¥ 70 000
```

**–ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç** –¥–æ–±–∞–≤–ª—è–µ—Ç:
- –û–±–æ—Ä–æ—Ç –∫–æ–º–ø–∞–Ω–∏–∏ (–ø—Ä–∏—Ö–æ–¥—ã + —Ä–∞—Å—Ö–æ–¥—ã).
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ ¬´–†–∞—Å—Å—Ä–æ—á–∫–∏¬ª –∏ ¬´–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏¬ª.
- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ –∫–∞–∂–¥–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É –∏ —Ç–∏–ø—É –æ–ø–µ—Ä–∞—Ü–∏–∏.

**–û—Ç—á—ë—Ç –∑–∞ –¥–µ–Ω—å** ‚Äî —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–∞–∑–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞ –∑–∞ —Ç–µ–∫—É—â–∏–µ —Å—É—Ç–∫–∏.

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `make logs` ‚Äî –ø–æ—Ç–æ–∫–∏ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–≤—Ö–æ–¥—è—â–∏–µ —Å–æ–±—ã—Ç–∏—è, –æ—Ç–≤–µ—Ç—ã).
- `make shell` ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- `make close-shifts` ‚Äî —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–º–µ–Ω.
- `make test` ‚Äî —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ –∏ –∑–∞–ø—É—Å–∫ pytest —Å SQLite (31 —Ç–µ—Å—Ç –ø–æ–∫—Ä—ã–≤–∞—é—Ç —Å–µ—Ä–≤–∏—Å—ã –∏ FSM).
- Cron –¥–ª—è –Ω–æ—á–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–º–µ–Ω (Europe/Moscow):
```
0 0 * * * cd /path/to/CRM_WA_BOT && \
  docker-compose run --rm app python -m crm_bot.scripts.close_shifts >> /var/log/close_shifts.log 2>&1
```

## –ü–æ–ª–µ–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- `docs/customer-guide.md` ‚Äî –≥–∞–π–¥ –¥–ª—è –∑–∞–∫–∞–∑—á–∏–∫–∞: ¬´–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º, –µ—Å–ª–∏ –≤—ã –Ω–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç¬ª.
- `docs/—Ç–∑.md` ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (—Å–º–µ–Ω—ã, –æ—Ç—á—ë—Ç—ã, —Ä–∞—Å—Å—Ä–æ—á–∫–∏).
- `tests/` ‚Äî –ø—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ API —Å–µ—Ä–≤–∏—Å–æ–≤.
- –û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: [https://github.com/ibras0696/WA_CRM_BOT](https://github.com/ibras0696/WA_CRM_BOT)

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –∏–¥—ë—Ç –Ω–µ —Ç–∞–∫:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–æ–º–µ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω (–¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞) –∏–ª–∏ whitelisted (–¥–ª—è –∞–¥–º–∏–Ω–∞).
- –í–≤–µ–¥–∏—Ç–µ `help`, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –Ω–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤.
- –ù–∞–ø–∏—à–∏—Ç–µ `–ê–¥–º–∏–Ω` –∏–ª–∏ `–ú–µ–Ω–µ–¥–∂–µ—Ä`, —á—Ç–æ–±—ã –ø—Ä–µ—Ä–≤–∞—Ç—å –ª—é–±–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é.
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ `make logs` ‚Äî —Ç–∞–º –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π –∏ –æ—Ç–≤–µ—Ç–æ–≤.
